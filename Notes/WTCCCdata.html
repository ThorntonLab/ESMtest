<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>WTCCC data</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>





</head>

<body>
<h1>WTCCC data</h1>

<p>The data consist of 7 panels of cases plus two panels of controls.  The controls are merged into one big control group.</p>

<p>The data codes are:</p>

<ol>
<li>1958BC = 1958 Birth Cohort, control</li>
<li>NBS = National Blood Service Registry, control</li>
<li>BD = Bipolar disorder, case</li>
<li>CAD = Coronary Artery Disease, case</li>
<li>HT = Hypertension, case</li>
<li>IBD = Inflammatory Bowel Disease, case</li>
<li>RA = Rheumatoid Arthritis, case</li>
<li>T1D = Type I Diabetes, case</li>
<li>T2D = Type II Diabetes, case</li>
</ol>

<h1>The data files</h1>

<p>The data files are in &ldquo;<a href="http://www.stats.ox.ac.uk/%7Emarchini/software/gwas/file_format.html">Chiamo</a>&rdquo; format.  This format is intended for use with <a href="https://mathgen.stats.ox.ac.uk/genetics_software/snptest/snptest.html">SNPTEST</a>, the software used for the original WTCCC analysis.  The output from SNPTEST is included with the data, but we&#39;ve never looked at it.</p>

<p>On task that we need to accomplish is Chiamo-to-PLINK format conversion.  There are hints of tools available online:</p>

<ol>
<li><a href="http://www.genabel.org/">GenABEL</a></li>
</ol>

<p>No idea if these work, or of the WTCCC formats are out-of-date with respect to what these files expect.</p>

<p>How are the data structured?</p>

<p>There are 25 gzipped text files with names like <strong>Affx_20070205fs1_gt_HT_Chiamo_01.txt.gz</strong>.  Files *_01.txt.gz through *_22.txt.gz represent the 22 autosomes.  The file ending in _24.txt.gz appears to represent the X/Y psuedoautosomal region (this was inferred via Google searching the SNP IDs).  The files ending in _23.txt.gz and _X.txt.gz both appear to be X chromosome data (again, via Googling SNP IDs).  Curiously, the two files contain many of the same SNPs, but <strong>NOT</strong> the same SNPs, which is totally bizarre:</p>

<pre><code class="sh">zcat Affx_20070205fs1_gt_HT_Chiamo_23.txt.gz|cut -f 1 | sort | uniq &gt; 23.snps
zcat Affx_20070205fs1_gt_HT_Chiamo_X.txt.gz|cut -f 1 | sort | uniq &gt; X.snps
wc -l *.snps
 10274 23.snps
 10536 X.snps
 head -n 10 *.snps
==&gt; 23.snps &lt;==
rs1000489
rs1000530
rs1001874
rs1002116
rs1003752
rs10047021
rs1004823
rs1004991
rs1005155
rs1005303

==&gt; X.snps &lt;==
rs1000489
rs1000530
rs1001874
rs1002116
rs1003752
rs10047021
rs1004823
rs1004991
rs1005155
rs1005303
</code></pre>

<p>Anyhow, we will probably follow tradition and ignore the X here anyways, focusing only in chr1-22.</p>

<p><strong>NOTE: the section below replaced real indentifiers, genotypes, etc. with REDACTED, as these data are covered by privacy concerns</strong></p>

<p>The genotype files have four columns.  These are SNP id, individual ID, genotype, and genotype score:</p>

<pre><code class="sh">rs3094315  WTCCCREDACTED    REDACTED    1.0000
rs3094315   WTCCCREDACTED   REDACTED    1.0000
rs3094315   WTCCCREDACTED   REDACTED    1.0000
rs3094315   WTCCCREDACTED   REDACTED    1.0000
rs3094315   WTCCCREDACTED   REDACTED    1.0000
rs3094315   WTCCCREDACTED   REDACTED    1.0000
rs3094315   WTCCCREDACTED   REDACTED    1.0000
rs3094315   WTCCCREDACTED   REDACTED    1.0000
rs3094315   WTCCCREDACTED   REDACTED    0.9989
rs3094315   WTCCCREDACTED   REDACTED    1.0000
</code></pre>

<p>In addition, each panel has a &ldquo;sample file&rdquo; with lines like this:</p>

<pre><code class="sh">WTCCCREDACTED      1       REDACTED      BRIGHT  11140A10        REDACTED  6       Unknown
WTCCCREDACTED      2       REDACTED      BRIGHT  11140A11        REDACTED        6       Unknown
WTCCCREDACTED      2       REDACTED      BRIGHT  11140A12        REDACTED        5       Unknown
</code></pre>

<p>The columns are:</p>

<ol>
<li>Individual ID</li>
<li>Sex (male = 1, female = 2)</li>
<li>Panel label</li>
<li>Unknown</li>
<li>Unknown</li>
<li>Origin</li>
<li>Unknown</li>
<li>Unknown</li>
</ol>

<p>Details of these file formats can be found <a href="http://www.wtccc.org.uk/info/data_formats.html">here</a>.</p>

<h1>Exclusion lists</h1>

<p>One complication of the data is that the raw genotype files cannot simply be used &ldquo;as-is&rdquo;.  Each panel comes with &ldquo;exclusion lists&rdquo; for both individuals and SNPs:</p>

<pre><code class="sh">find . -name &quot;exclusion*&quot;|grep -v gpg
./1958BC/20070205fs1/exclusion-list-05-02-2007.txt
./1958BC/20070205fs1/exclusion-list-snps-26_04_2007.txt
./1958BC/exclusion-list-05-02-2007.txt
./1958BC/exclusion-list-snps-26_04_2007.txt
./BD/exclusion-list-05-02-2007-BD.txt
./BD/exclusion-list-snps-26_04_2007.txt
./CAD/exclusion-list-05-02-2007-CAD.txt
./CAD/exclusion-list-snps-26_04_2007.txt
./HT/exclusion-list-snps-26_04_2007.txt
./HT/exclusion-list-05-02-2007-HT.txt
./IBD/exclusion-list-snps-26_04_2007.txt
./IBD/exclusion-list-05-02-2007-CD.txt
./NBS/20070205fs1/exclusion-list.txt
./NBS/20070205fs1/exclusion-list-snps-26_04_2007.txt
./NBS/exclusion-list.txt
./NBS/exclusion-list-snps-26_04_2007.txt
./RA/exclusion-list-snps-26_04_2007.txt
./RA/exclusion-list-05-02-2007-RA.txt
./T1D/exclusion-list-05-02-2007-T1D.txt
./T1D/exclusion-list-snps-26_04_2007.txt
./T2D/exclusion-list-05-02-2007-T2D.txt
./T2D/exclusion-list-snps-26_04_2007.txt
</code></pre>

<p>Let&#39;s look at a file excluding individuals.  We see four columns: panel label, SOMETHING, individual label reason for exclusion:</p>

<pre><code class="sh">cat ./HT/exclusion-list-05-02-2007-HT.txt
#1. Affy CEL file bad
#2. Missing &gt; 3%
#3. Het &gt; 0.3 || Het &lt; 0.225
#4a. External discordance: DIL genotyping
#4b. External discordance: NBS blood type
#4c. External discordance: phenotype measure in CD.
#5. Non-european ancestry
#6a. Sent twice by Sanger
#6b. Duplicated at unknown stage
#7. 1st/2nd degree relatives
REDACTED  19378A2   WTCCC169703 1,2
REDACTED    17947G12    WTCCC169139 2
REDACTED    18786F8 WTCCC169437 2
REDACTED    18786H5 WTCCC169489 2
REDACTED    18795B1 WTCCC169403 2
REDACTED    18795C6 WTCCC169367 2
REDACTED    18795G2 WTCCC169392 2
REDACTED    18796A7 WTCCC169977 2
#etc... (rest of file not shown)
</code></pre>

<p>And how the top of a SNP exclusion file.  The columns are pretty straightforward:</p>

<pre><code class="sh">head -n 20 ./HT/exclusion-list-snps-26_04_2007.txt 
# The following 3 filters were applied sequentially. The number of the first filter a snp fails is gven in the FILTER column.
#1. (Studywise missing data proportion &gt; 0.05) OR (Studywise minor allele frequency &lt; 0.05 AND Studywise missing data proportion &gt; 0.01)
#2. 58C+NBS HWE Exact Test p-value &lt; 5.7e-7
#3. (58C vs NBS 1df Trend Test p-value &lt; 5.7e-7) OR (58C vs NBS 2df General Test p-value &lt; 5.7e-7)
CHR  AFFY_ID    RS_ID   FILTER
1   SNP_A-2169457   rs3817856   2
1   SNP_A-2218153   rs12141314  1
1   SNP_A-1842509   rs2292857   1
1   SNP_A-4218776   rs262683    2
1   SNP_A-2038545   rs4648515   1
1   SNP_A-1785968   rs12119163  2
1   SNP_A-4242198   rs4648451   1
1   SNP_A-4250429   rs2981884   1
1   SNP_A-2242875   rs6704012   1
1   SNP_A-2107218   rs2651912   1
1   SNP_A-4218510   rs6670518   1
1   SNP_A-2206691   rs6690558   1
1   SNP_A-2219183   rs2483280   1
1   SNP_A-1786405   rs16823663  1
1   SNP_A-2258506   rs13375075  1
</code></pre>

<h1>So what needs to be done?</h1>

<p>We need the following:</p>

<ol>
<li> Chiamo-to-PED/MAP conversion.  It looks like there are tools to take PED/MAP to other formats, so we may have to write our own.</li>
</ol>

</body>

</html>

